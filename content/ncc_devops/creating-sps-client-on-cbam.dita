<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="id9YZ-09126-MT02-REZZA-Creating-SPS-client-on-CBAM"><title>Creating a client on CBAM for API access</title><taskbody id="d1e2827"><context>
                                                  <p>This procedure provides instructions on how to
                                                  register a client on the Keycloak Administration
                                                  Console for sending authenticated requests to the
                                                  CBAM REST API to use the NCC instantiation
                                                  scripts. For more information on CBAM, see CBAM
                                                  documentation.</p>
                                                  <note>
                                                  <p>For information on CBAM, see CBAM documentation
                                                  <!--xref URI: ../IP/SPS_Devops.xml#document_support--><xref
                                                  href="c_document_support.dita"/>.</p>
                                                  </note>
                                                  <p>To create the NCC client:</p>
                                                  </context><steps>
<step><cmd>Log in to the Keycloak Administration Console. For information on how to log in to the Keycloak Administration Console, see the CBAM Administrator Guide.</cmd><info/></step>
<step><cmd>From the <b>Configure</b> menu, select <b>Clients</b>. The <b>Clients</b> pane appears.</cmd><info/></step>
<step><cmd>In the <b>Clients</b> pane, click the <b>Create</b> button. The <b>Add Client</b> pane appears.</cmd><info/></step>
<step><cmd>In the <b>Add Client</b> pane, define the <b>Client ID</b> by entering a unique meaningful name that will allow you to identify the client. Click <b>Save</b>.</cmd><info><p>
<b>Expected outcome</b>
</p><p>
<systemoutput>Success! The client has been created.</systemoutput>
</p></info></step>
<step><cmd>In the updated <b>Add Client</b> pane, do the following:</cmd><info><ul>
<li>
<p>In the Access Type drop-down list select <varname>confidential</varname> to allow Keycloak to generate a clientâ€™s secret that serves as a password.</p>
</li>
<li>
<p>Set the <b>Standard Flow Enabled</b> to <varname>off</varname>. However, if you are going to use the Authorization Code Flow, set the <b>Standard Flow Enabled</b> to <varname>on</varname>.</p>
</li>
<li>
<p>Set the <b>Direct Access Grants Enabled</b> to <varname>on</varname> to enable the Resource Owner Password Credentials Grant.</p>
</li>
<li>
<p>Set the <b>Service Accounts Enabled</b> to <varname>on</varname> to enable the Client Credentials Grant.</p>
</li>
</ul></info></step>
<step><cmd>If you are using CBAM 18.5 or higher, do the following. Otherwise, go to the next step.</cmd><info><p>In the updated <b>Add Client</b> pane, click the <b>Service Account Roles</b> tab and do the following:</p><ol>
<li>
<p>In the list of <b>Available Roles</b>, select <varname>all_permissions</varname>.</p>
</li>
<li>
<p>Click the <b>Add selected</b> button.</p>
</li>
<li>
<p>Verify that the <varname>all_permissions</varname> role is shown in the list of <b>Assigned Roles</b> and <b>Effective Roles</b>.</p>
</li>
</ol></info></step>
<step><cmd>Click the <b>Save</b> button.</cmd><info><p>
<b>Expected outcome</b>
</p><p>
<systemoutput>Success! Your changes have been saved to the client.</systemoutput>
</p></info></step>
<step><cmd>Copy and save the <b>Secret</b> string as follows:</cmd><info><ul>
<li>
<p>Click the <b>Credentials</b> tab. The <b>Credentials</b> window appears.</p>
</li>
<li>
<p>In the <b>Credentials</b> window, capture the <b>Secret</b> string to use in <filepath>clouds-config.yaml</filepath> file for instantiation.</p>
</li>
</ul><note>
<p>
<b>Secret</b> is a captured secret key generated when the client is created.</p>
</note></info></step>
</steps>
</taskbody></task>